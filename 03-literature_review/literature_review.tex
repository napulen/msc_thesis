\chapter{Literature review}
Most researchers agree that the pioneer work addressing the problem of harmonic analysis is the approach made by Terry Winograd in 1968 \cite{winograd1968linguistics}. Since then, researchers have developed over the idea of harmonic analysis in very different ways.
  
One possible reason for this is how wide and different the harmony of different kinds of music could be. Even restricting ourselves to tonal music, we would still comprehend a range of music as wide as late 16th century's Claudio Monteverdi to 20th century jazz fusion's Allan Holdwsworth. In that sense, an automatic harmonic analysis approach should be able to reach and point out interesting things about music, but what kind of music. In practice, it is difficult that one approach could serve all sorts of music and at the same time deal with the details, common practices and corner cases from these different music styles and periods. Therefore, researchers have systematically split their efforts to target specific kinds of music, and even sometimes, specific composers.

Among the approaches that cover different kinds of music, there is the General Chord Type (GCT) representation from Emilios Cambouropoulos \cite{cambouropoulos2014idiom}, which is intended to be used in the universal classification of chord verticals according to the idiom that is trying to model. This model is not restricted to tonal music, having the possibility of working in atonal music as well, however, as I stated before, such a flexible model does not deal with the complex and specific scenarios of tonal music, in this case, simply because it is not designed to do it.
The natural separation that has emerged among researches is to either tackle harmonic analysis targetting classical music or jazz music. As the interest of my work is classical music, I will only briefly describe some of the pillar works in the context of jazz harmonic analysis.

Many works and research could be derived from the study of harmonic analysis, however, during \autoref{chap:introduction} I presented the definition of the task of automatic harmonic analysis that I use for this work.






\label{chap:literature-review}
During \autoref{chap:introduction}, I presented three possible sets of harmonic labels for a fragment of music, which can be seen in \autoref{fig:harmonic-labels}. I will start this chapter by describing the decision over the particular set of harmonic labels used in this work and the influence of music theory
\section{Labeling harmonic structures}
  \subsection{Chord labels}
  \subsection{Figured bass}
  \subsection{Roman numerals}
  \subsection{}
\section{Harmonic analysis in music theory}

% Harmonic analysis could be seen from different perspectives, the first one I would like to address is how it was conceived and modeled by music theorists. Starting with the french composer Jean-Philippe Rameau (1683-1764), until the theory from the german theorist Hugo Riemann (1849-1919) in the late nineteenth century.
%   \subsection{Fundamental bass}
%   The original idea by Rameau was based on the movement of the bass note, the so called \emph{Fundamental Bass}, which constructed rules and principles of how the movement of a bass note determined also the movement of the harmony. Rameau's theory limited the dictionary of chords to triads and some special cases of seventh chords, and considered chord inversions for the first time, from which the core concept of harmonic root arises and suggests that the bass note could be serving a harmonic root located in the superior voices. This theory is pioneer in separating the melodic movement and coincidence in time from counterpoint \cite{beach1974origins}, and looking at the music from a vertical perspective, a vision that spread in the following periods of western art music.
%   \subsection{Root succession tables}
%   These set of theories, denomined by Tymoczko as \emph{scale-degree} theories \cite{tymoczko2001root}, assign a number to each of the degrees in a scale, which represents its triad, and then trying to infer the most common succession of that particular scale degree to another. This theories have been used commonly in Harmony text books, and in principle, the scale-degree transitions have not been obtained scientifically. However, due to the probabilistic nature of these theories, there have been recent efforts in validating their statements and accuracy using computational resources, such as first-order Markov models.
%   \subsection{Functional harmony}
%   In 1893, Hugo Riemann presented his \emph{Vereinfachte Harmonielehre}, which placed together ideas and theories from himself and earlier theorists, and gave birth to what is called \emph{Functional Harmony}. The most notable, and allegedly controversial, characterization that comes from the functions theory, is the idea of categorization of chords. Functional harmony considers that chords belong to one of three tonal functions:
%   \begin{itemize}
%     \item Tonic
%     \item Subdominant
%     \item Dominant
%   \end{itemize}
%   These functions contain all individual chords, but are essentially represented by the primary triads: I, IV and V.
%   Due to this categorization of chords, functional harmony contains more information about tonal contexts and semantics, and therefore, as an analysis output becomes more interesting than fundamental bass or root succession theories.
\section{Automatic harmonic analysis}
Most researchers agree that the pioneer work in this problem was the approach from Winograd in 1968 \cite{winograd1968linguistics}. Since then, researchers have developed this idea in very different ways. I will discuss some of the methods and models used for harmonic analysis problems, which may have quite different purposes in mind.

  \subsection{Target musical style}
  Tonal music could comprehend a wide range of music as early baroque's Claudio Monteverdi to 20th century jazz fusion's Allan Holdwsworth. In that sense, an automatic harmonic analysis approach should be able to reach and point out interesting things about all these kinds of music. In practice, however, it is difficult that one approach could serve all sorts of tonal music and at the same time deal with the details, common practices and corner cases from these different music styles and periods. Researchers have systematically split their efforts to target specific kinds of music, and even sometimes, specific composers.
  Among the approaches that cover different kinds of music, there is the General Chord Type (GCT) representation from Emilios Cambouropoulos \cite{cambouropoulos2014idiom}, which is intended to be used in the universal classification of chord verticals according to the idiom that is trying to model. This model is not restricted to tonal music, having the possibility of working in atonal music as well, however, as I stated before, such a flexible model does not deal with the complex and specific scenarios of tonal music, in this case, simply because it is not designed to do it.
  The natural separation that has emerged among researches is to either tackle harmonic analysis targetting classical music or jazz music. As the interest of my work is classical music, I will only briefly describe some of the pillar works in the context of jazz harmonic analysis.
    \subsubsection{Jazz harmonic analysis}
    After Winograd, probably one of the pillar works in harmonic analysis for jazz is that of John Wade Ulrich \cite{ulrich1977analysis}. This work developed a functional analysis, identifying the function of each chord in a musical piece. The input for this model was a sequence of chords and it incorporated the detection of keys. Among some of the restrictions it has is that it does not work for music in a minor tonality, and constraints chord changes to occur once every beat.
    Following to the model from Ulrich, probably one of the next pillars in harmonic analysis oriented to jazz music and a direct successor to the baseline of Ulrich is the model from Francois Pachet \cite{pachet2000computer} who presents a hierarchical model to analyze jazz harmonic progressions, similarly taking as input a sequence of chords and deriving a hierarchical description of modulations. This model does not consider voice-leading and lands in the more "hierarchical" type of analysis, which give structure to a set of chord labels. It was later extended by Ricardo Scholz \cite{scholz2005automating} who attempted to incorporate modal borrowings and secondary dominants.
    From these research, we can infer an important fact, most of the jazz oriented approaches lie within the context of \emph{hierarchical} approaches to functional harmony, and oftenly trivialize the input to chord labels to focus on the functional hierarchies themselves. One of the most important problems in classical music, for example, is precisely in how to deal with all these melodic streams before they can be considered chord labels. This happens maybe because the harmonic movement in Jazz is much more aggressive and departs from a tonal center with ease, making the effort of tracking fast-moving tonal centers an attractive problem, and melodic, polyphonical implications of the music less useful, whereas in classical music it is usual to well-establish one tonal center before moving to the next, at least for the classical period, but extracting the implied tonal function within the different melodic streams is not a trivial task to solve. These characteristics of the music styles probably point out and justify the motivations for separating the models according to the music that is being analyzed.
    As the target music of this work belongs to the early Classical period in western art music, I will be dealing with the approaches concerning this kind of music, with special attention to those approaches that attempt to solve the problem entirely, without assuming an input of chord labels, but a full musical score.
  \subsection{Harmonic analysis chronology}
  Once established that this work is dealing with music from the Classical period and therefore its interest is in the approaches that attempt to provide an automatic harmonic analysis of such subset of tonal music, I will start to describe some of the remarkable efforts done, putting special emphasis to their contributions, inputs, outputs and flaws.
    \subsubsection{The pioneer work by Terry Winograd}
    As it was stated before, researchers in the field mostly mention the approach from Terry Winograd, in 1968, as the pioneer work in the field. This work is not only important because it is the first and pioneering work in computing a functional harmonic analysis, but also because it linked the computational techniques used in natural language processing to music. The model from Winograd was evaluated over music from Johann Sebastian Bach, and pretends to output a functional harmonic analysis of such pieces of music. To provide an output, it requires a preliminary hand-made conversion of the original score and turn it into a sequence of four-part perfect chords. This allowed him to process a score using his implementation in the LISP programming language, but it also means that during this pre-processing stage the non-harmonic tones are eliminated before solving the problem. In his 1997 harmonic analysis algorithm \cite{temperley1997algorithm}, David Temperley provided insight about the flaws of Winograd's model, among them he mentions the issues concercing melodic seggregation and arpeggiations.
    \subsubsection{Expert system from Maxwell}
    A direct successor of Winograd's approach, the model from John Maxwell, which was part of his PhD dissertation in 1984, and successively published in 1992 \cite{maxwell1992expert}, is probably the best example of the rule-based approaches towards harmonic analysis. Same as Winograd, Maxwell's target was to output a functional harmonic analysis from a music score. The model from Maxwell has fifty five rules that pretend to reduce the vertical sonorities into a chord sequence, and then deciding for key changes. Some of the rules are intuitive and basic, e.g., \emph{"Perfect and imperfect consonant intervals constitute a consonant interval. Every other is a dissonant interval."}, while others appear cryptic and difficult to understand, e.g., \emph{"If the goal chord falls on a strong beat and it is a major triad or major-minor seventh, and the root movement from the pre-cadence is an ascending or descending perfect fifth or major second or a descending minor second, and when the root motion is a descending fifth, the pre-cadence is not a potential dominant, and when the root motion is an ascending fifth the pre-cadence is triadic, then the pseudo-cadence is a half cadence, and its strength increases by 10."}.
    The later rule also reveals a problem that was pointed out by future researchers, the use of arbitrary, fixed values while determining the strength of a cadence. Even so, the results of Maxwell's approach get really close to the outcome expected by a music theorist analyzing a music score and determining its functional harmony. This work was tested over three different movements of Johann Sebastian Bach's Six French Suites: The sarabande from Suite No.1, the menuet from Suite No.2 and the gavotte from Suite No.5. The pieces selected comprehend different problems and levels of complexity to be addressed: Four-part harmony with several non-harmonic tones, 2-voice continuous contrapuntual movement, and a varying contrapuntual texture, respectively. David Temperley put the limitations of Winograd and Maxwell's approaches pretty close together, summarizing them in the following:
		\begin{itemize}
			\item Sequences of notes that are not displayed simultaneously (vertically), as arpeggiations of chords.
			\item Missing pitches in the spelling of a full chord, which can be deduced from the context.
			\item Ornamental notes. Maxwell proposes specific rules to deal with these notes, but according to Temperley, neither Maxwell's or Winograd's are good enough to correctly detect ornamental notes.
    \end{itemize}
    Maxwell's approach, in general, represents the powerful and sophisticated machinery of rule-based approaches, as well as their complexity.
    \subsubsection{Temperley and the Melisma Music Analyzer}
    Probably the most relevant approach in automatic harmonic analysis for this work, is the approach from David Temperley described in 1997 \cite{temperley1997algorithm}, as it was extended afterwards by his work in key estimation algorithms and which culminated in the implementation of the Melisma Music Analyzer, in conjunction with Daniel Sleator.
    Inspired by the cognitive experiments by Carol Krumhansl \cite{krumhansl2001cognitive}, the aim of Temperley is to produce an algorithm that models the human process of harmonic analysis done by a trained expert, and to take it as indicative of the analysis produced subconsciously by listeners in general.

		The traiditional functional harmonic analysis done in music theory courses uses the \emph{roman numerals} notation to segment a piece of music, labeling it with symbols indicating the relationship between each root to the current key. Temperley steps forward in the definition of the problem of harmonic analysis, decomposing the task into two subtasks: \emph{root finding} and \emph{key finding}. Temperley claims then that functional harmonic analysis could be broken down into these subtasks, focusing at first in root finding, assuming that this task can be done independently to key finding. Root finding basically consists of dividing a piece into segments and label each of them with a root.

    Once in the task of root-finding, Temperley approaches the task defining certain rules: \emph{Pitch variance rule, compatibility rule, strong-beat rule, harmonic variance rule and ornamental dissonance rule}. Together with these rules, he introduces important definitions that aid in the process of root analysis: The concepts of \emph{Tonal Pitch Class} (TPC), \emph{Center of Gravity} (COG) and the \emph{line of fifths}.

    It is difficult to follow the chronology of this approach, as the implementation of this model comes mainly in the form of the Melisma Music Analyzer, which was released in 2001, and included the key estimation algorithm and a combined mode that eventually performed the complete functional harmonic analysis. The latest mode being the core implementation of what will be used to compute automatic harmonic analysis during this work.

    \subsubsection{Probabilistic and statistical approaches}
    Temperley himself, after the release of the Melisma Music Analyzer, moved into the direction of probabilistic models. In his case, using a Bayesian approach that aims to provide a unified modeling of harmonic analysis, meter induction and melodic seggregation, challenging the individualization of these problems without considering the connections among them \cite{temperley2009unified}.

    However, previous to this work, an important probabilistic approach that emerged to solve the problem of functional harmonic analysis was that of Christopher Raphael \cite{raphael2003harmonic}.
    This model from Raphael is one of the few pure-functional harmonic analysis approaches, oriented towards the analysis of common-practice music. The idea is simple and some of his assumptions simplify the parameters of the model. Some constant that remains as in previous models is the fact that it gets rid of all the pitch-spelling information and replaced for solely pitch information. This model, unlike Temperley, does not try to reconstruct the pitch spelling information back by any algorithmic means, and in the words of Raphael, it is an obvious extension to the model.

    Another quite important effort in the statistical domain includes the work from Martin Rohrmeier \cite{rohrmeier2008statistical}, who uses a heuristic method of segmentation. Analyzes distributions of single pitch-class-sets, chord classes and pitch-class-sets transitions. One of the goals of Rohrmeier was the research of \emph{syntacticality} in harmony. The final goal is to produce descriptive analyses of harmonic structure based on an empirical approach. The choice of the corpus is, similarly to others, music from Joahann Sebastian Bach. In his case, chorales, because they constitute a large and coherent set of pieces regarding style and composition technique. Rohrmeier claims that this work is pioneer in the statistical analysis of a corpus for the purpose of finding features of tonal harmony. According to the results of Rohrmeier, the most frequent occurrences of pitch-class-sets in this music are those of tonic, dominant and subdominant chords. This would be expected and helps to reinforce those scale-degree theories that describe harmonic movement with transition tables of scale degrees. The results from this research, apart from being interesting in confirming music-theory beliefs regarding common chords and transitions in tonal music, could also be replicated in a different corpus to target its particular common chords and transitions.

    \subsubsection{Grammar-based}
    Three years after his statistical work in Bach Chorales, Martin Rohrmeier brought back the use of grammars to study the underlying structure of musical harmony \cite{rohrmeier2011towards}, which inspired future works by other researchers in the field, specially towards analyzing jazz music. In this work, Rohrmeier claims that the structure of harmonic progressions exceeds the simplicity of a markovian transition table, and he proposes a set of phrase-structure grammar rules. For this purpose, the hierarchical analysis from the music-theory approach done by \cite{kostka1995tonal} is presented, with the belief that it can be brought to a closer formalization. Rohrmeier presents a tree representation of a chord sequence, using two principles:
    \begin{itemize}
			\item Chords have dependencies and the existence of one sometimes requires the existence of another
			\item Chords have functions, these functions can be realized by a set of chords.
		\end{itemize}
    The system comprises 27 rules for the generation of a grammar, this helps to model common-practice music as well as jazz music. The output of this algorithm is a hierarchical tree of the functions and dependencies of the chords. The level of detail from this work to model every special case of the harmonic language is remarkable, as careful attention has been put trying to comprehend distinct kinds of cadences, chords and modulations in the model.

    This work was eventually retaken and implemented by Bas de Haas \cite{de2013automatic} using chord labels as input for the system.

    As discussed previously, different methods of performing harmonic analysis oftenly have different outputs in mind, considering this, I will mention that even if the hierarchical representations of harmony appear interesting and promising, the aim for this work is to provide music scores as input and produce an automatic harmonic analysis as output. In this sense, the most relevant approaches can be reduced simply to those approaches who pretend to output exactly that.

  \subsection{Functional harmonic analysis}
  From the previously mentioned efforts of harmonic analysis, those that explicitly pretend to output a functional harmonic analysis from a music score, are the following:
  \begin{table}[tbp]
    \centering
    \caption{Automatic functional harmonic analysis approaches}
    \label{my-label}
    \begin{tabular}{llll}
      Approach & Year & Implementation & Availability \\
      Winograd & 1968 & LISP & No \\
      Maxwell & 1992 & LISP & No \\
      Temperley & 1997\footnote{The span of time between this approach was presented as a paper and the current implentation used for this work, is much wider, reaching changes in code done during 2017} & C & Yes \\
      Raphael & 2003 & C & Partial \\
      Illescas & 2008 & Java & Partial
    \end{tabular}
  \end{table}
  From the approaches shown in Table 1, results evident that the decision over the approach used as the baseline for this work performing an automatic harmonic analysis is that of David Temperley, which is related to the Melisma Music Analyzer. Simply put, because it is the most mature approach in terms of reproducibility and applicability to large volumes of music, like the string quartet dataset used in this work, which will be described later.
  \textbf{Note: 27th of June of 2017}
  I am missing a further explanation of the datasets currently available and the decision to use Haydn's music and the Op.20 String Quartets. This will be added later.

\newpage
